<!DOCTYPE html>
<html lang="en">
<head>

    <!--[if lt IE 9]>
        <style>body {display: none; background: none !important} </style>
        <meta http-equiv="Refresh" Content="0; url=//outdatedbrowser.com/" />
    <![endif]-->

<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="format-detection" content="telephone=no" />
<meta name="author" content="Jarvis Yao" />



<meta name="description" content="å‰æ–‡å¯¹æœ¬ä¹¦çš„çš„è¯„è®ºæ— å¤–ä¹æ˜¯â€œæœ¬ç¨‹åºå‘˜çš„æ¡ˆå¤´ä¹¦â€ï¼Œâ€œå¦‚æœèƒ½åœ¨èŒä¸šç”Ÿæ¶¯åˆæœŸè¯»åˆ°è¿™æœ¬ä¹¦èƒ½å°‘å†™å¤šå°‘æ¶è‡­çš„ä»£ç â€äº‘äº‘ã€‚è¨€è€Œæ€»ä¹‹ï¼Œè¿™æœ¬ä¹¦åº”è¯¥ç›¸å½“é€‚åˆåˆå…¥èŒåœº&#x2F;å°šæœªå½¢æˆä¸ªäººä»£ç é£æ ¼&#x2F;è¯»åˆ°å±å±±ä¸æ˜¯é€‰æ‹©å«æ³ªç”Ÿåè€Œæ˜¯æƒ³æŠŠå§‹ä½œä¿‘è€…æ´»å‰¥&#x2F;ä¸€ä¸ªæœ‰å…¬å¾·å¿ƒçš„ä»£ç è´¡çŒ®è€…çš„fresh coderã€‚">
<meta property="og:type" content="article">
<meta property="og:title" content="é‡æ„æ”¹å–„ç°æœ‰ä»£ç çš„è®¾è®¡ç¬”è®°">
<meta property="og:url" content="https://hejabvbreus11.github.io/2020/05/04/code_refractoring/index.html">
<meta property="og:site_name" content="Pikachu-Thunderbolt">
<meta property="og:description" content="å‰æ–‡å¯¹æœ¬ä¹¦çš„çš„è¯„è®ºæ— å¤–ä¹æ˜¯â€œæœ¬ç¨‹åºå‘˜çš„æ¡ˆå¤´ä¹¦â€ï¼Œâ€œå¦‚æœèƒ½åœ¨èŒä¸šç”Ÿæ¶¯åˆæœŸè¯»åˆ°è¿™æœ¬ä¹¦èƒ½å°‘å†™å¤šå°‘æ¶è‡­çš„ä»£ç â€äº‘äº‘ã€‚è¨€è€Œæ€»ä¹‹ï¼Œè¿™æœ¬ä¹¦åº”è¯¥ç›¸å½“é€‚åˆåˆå…¥èŒåœº&#x2F;å°šæœªå½¢æˆä¸ªäººä»£ç é£æ ¼&#x2F;è¯»åˆ°å±å±±ä¸æ˜¯é€‰æ‹©å«æ³ªç”Ÿåè€Œæ˜¯æƒ³æŠŠå§‹ä½œä¿‘è€…æ´»å‰¥&#x2F;ä¸€ä¸ªæœ‰å…¬å¾·å¿ƒçš„ä»£ç è´¡çŒ®è€…çš„fresh coderã€‚">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/15098936-46dea6b1bf5c81d7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://hejabvbreus11.github.io/img/pseudograph.png">
<meta property="article:published_time" content="2020-05-04T03:06:09.000Z">
<meta property="article:modified_time" content="2020-05-05T08:52:17.888Z">
<meta property="article:author" content="Jarvis Yao">
<meta property="article:tag" content="è®¾è®¡ä¸é‡æ„">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://upload-images.jianshu.io/upload_images/15098936-46dea6b1bf5c81d7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">

<link rel="apple-touch-icon" href= "/apple-touch-icon.png">


    <link rel="alternate" href="/atom.xml" title="Pikachu-Thunderbolt" type="application/atom+xml">



    <link rel="shortcut icon" href="/img/pokemon.png">



    <link href="//cdn.bootcss.com/animate.css/3.5.1/animate.min.css" rel="stylesheet">



    <link href="//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.css" rel="stylesheet">



    <script src="//cdn.bootcss.com/pace/1.0.2/pace.min.js"></script>
    <link href="//cdn.bootcss.com/pace/1.0.2/themes/blue/pace-theme-minimal.css" rel="stylesheet">



<link rel="stylesheet" href="/css/style.css">




<link href="//cdn.bootcss.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet">


<title>é‡æ„æ”¹å–„ç°æœ‰ä»£ç çš„è®¾è®¡ç¬”è®° | Pikachu-Thunderbolt</title>

<script src="//cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>
<script src="//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js"></script>

<script>
    var yiliaConfig = {
        fancybox: true,
        animate: true,
        isHome: false,
        isPost: true,
        isArchive: false,
        isTag: false,
        isCategory: false,
        fancybox_js: "//cdn.bootcss.com/fancybox/2.1.5/jquery.fancybox.min.js",
        scrollreveal: "//cdn.bootcss.com/scrollReveal.js/3.1.4/scrollreveal.min.js",
        search: false
    }
</script>


    <script> yiliaConfig.jquery_ui = [false]; </script>



    <script> yiliaConfig.rootUrl = "\/";</script>






<meta name="generator" content="Hexo 4.2.0"></head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
    <header id="header" class="inner">
        <a href="/" class="profilepic">
            <img src="/img/avatar.png" class="animated zoomIn">
        </a>
        <hgroup>
          <h1 class="header-author"><a href="/">Jarvis Yao</a></h1>
        </hgroup>

        

        


        
            <div id="switch-btn" class="switch-btn">
                <div class="icon">
                    <div class="icon-ctn">
                        <div class="icon-wrap icon-house" data-idx="0">
                            <div class="birdhouse"></div>
                            <div class="birdhouse_holes"></div>
                        </div>
                        <div class="icon-wrap icon-ribbon hide" data-idx="1">
                            <div class="ribbon"></div>
                        </div>
                        
                        <div class="icon-wrap icon-link hide" data-idx="2">
                            <div class="loopback_l"></div>
                            <div class="loopback_r"></div>
                        </div>
                        
                        
                        <div class="icon-wrap icon-me hide" data-idx="3">
                            <div class="user"></div>
                            <div class="shoulder"></div>
                        </div>
                        
                    </div>
                    
                </div>
                <div class="tips-box hide">
                    <div class="tips-arrow"></div>
                    <ul class="tips-inner">
                        <li>Menu</li>
                        <li>Tags</li>
                        
                        <li>Friends</li>
                        
                        
                        <li>About Me</li>
                        
                    </ul>
                </div>
            </div>
        

        <div id="switch-area" class="switch-area">
            <div class="switch-wrap">
                <section class="switch-part switch-part1">
                    <nav class="header-menu">
                        <ul>
                        
                            <li><a href="/">ä¸»é¡µ</a></li>
                        
                            <li><a href="/archives/">æ‰€æœ‰æ–‡ç« </a></li>
                        
                            <li><a href="/tags/">æ ‡ç­¾äº‘</a></li>
                        
                            <li><a href="/about/">å…³äºæˆ‘</a></li>
                        
                        </ul>
                    </nav>
                    <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" href="mailto:hejabvbreus11@163.com" title="Email"></a>
                            
                                <a class="fa GitHub" href="https://github.com/Pikachu-Thunderbolt/Pikachu-Thunderbolt.github.io" target="_blank" rel="noopener" title="GitHub"></a>
                            
                                <a class="fa ç®€ä¹¦" href="https://www.jianshu.com/u/56535d652ced" target="_blank" rel="noopener" title="ç®€ä¹¦"></a>
                            
                        </ul>
                    </nav>
                </section>
                
                
                <section class="switch-part switch-part2">
                    <div class="widget tagcloud" id="js-tagcloud">
                        <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AE%BE%E8%AE%A1%E4%B8%8E%E9%87%8D%E6%9E%84/" rel="tag">è®¾è®¡ä¸é‡æ„</a></li></ul>
                    </div>
                </section>
                
                
                
                <section class="switch-part switch-part3">
                    <div id="js-friends">
                    
                      <a class="main-nav-link switch-friends-link" href="https://hexo.io" target="_blank" rel="noopener">Hexo</a>
                    
                      <a class="main-nav-link switch-friends-link" href="https://pages.github.com/" target="_blank" rel="noopener">GitHub</a>
                    
                      <a class="main-nav-link switch-friends-link" href="http://moxfive.xyz/" target="_blank" rel="noopener">MOxFIVE</a>
                    
                    </div>
                </section>
                

                
                
                <section class="switch-part switch-part4">
                
                    <div id="js-aboutme">ä¸“æ³¨äºå‰ç«¯</div>
                </section>
                
            </div>
        </div>
    </header>                
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
      <div class="overlay">
          <div class="slider-trigger"></div>
          <h1 class="header-author js-mobile-header hide"><a href="/" title="å›åˆ°ä¸»é¡µ">Jarvis Yao</a></h1>
      </div>
    <div class="intrude-less">
        <header id="header" class="inner">
            <a href="/" class="profilepic">
                <img src="/img/avatar.png" class="animated zoomIn">
            </a>
            <hgroup>
              <h1 class="header-author"><a href="/" title="å›åˆ°ä¸»é¡µ">Jarvis Yao</a></h1>
            </hgroup>
            
            <nav class="header-menu">
                <ul>
                
                    <li><a href="/">ä¸»é¡µ</a></li>
                
                    <li><a href="/archives/">æ‰€æœ‰æ–‡ç« </a></li>
                
                    <li><a href="/tags/">æ ‡ç­¾äº‘</a></li>
                
                    <li><a href="/about/">å…³äºæˆ‘</a></li>
                
                <div class="clearfix"></div>
                </ul>
            </nav>
            <nav class="header-nav">
                        <ul class="social">
                            
                                <a class="fa Email" target="_blank" href="mailto:hejabvbreus11@163.com" title="Email"></a>
                            
                                <a class="fa GitHub" target="_blank" href="https://github.com/Pikachu-Thunderbolt/Pikachu-Thunderbolt.github.io" title="GitHub"></a>
                            
                                <a class="fa ç®€ä¹¦" target="_blank" href="https://www.jianshu.com/u/56535d652ced" title="ç®€ä¹¦"></a>
                            
                        </ul>
            </nav>
        </header>                
    </div>
    <link class="menu-list" tags="Tags" friends="Friends" about="About Me"/>
</nav>
      <div class="body-wrap"><article id="post-code_refractoring" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2020/05/04/code_refractoring/" class="article-date">
      <time datetime="2020-05-04T03:06:09.000Z" itemprop="datePublished">2020-05-04</time>
</a>


    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      é‡æ„æ”¹å–„ç°æœ‰ä»£ç çš„è®¾è®¡ç¬”è®°
    </h1>
  

      </header>
      
      <div class="article-info article-info-post">
        
    <div class="article-category tagcloud">
    <a class="article-category-link" href="/categories/%E8%AF%BB%E4%B9%A6%E7%AC%94%E8%AE%B0/">è¯»ä¹¦ç¬”è®°</a>
    </div>


        
    <div class="article-tag tagcloud">
        <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E8%AE%BE%E8%AE%A1%E4%B8%8E%E9%87%8D%E6%9E%84/" rel="tag">è®¾è®¡ä¸é‡æ„</a></li></ul>
    </div>

        <div class="clearfix"></div>
      </div>
      
    
    <div class="article-entry" itemprop="articleBody">
      
          
        <h1 id="å‰æ–‡"><a href="#å‰æ–‡" class="headerlink" title="å‰æ–‡"></a>å‰æ–‡</h1><p>å¯¹æœ¬ä¹¦çš„çš„è¯„è®ºæ— å¤–ä¹æ˜¯â€œæœ¬ç¨‹åºå‘˜çš„æ¡ˆå¤´ä¹¦â€ï¼Œâ€œå¦‚æœèƒ½åœ¨èŒä¸šç”Ÿæ¶¯åˆæœŸè¯»åˆ°è¿™æœ¬ä¹¦èƒ½å°‘å†™å¤šå°‘æ¶è‡­çš„ä»£ç â€äº‘äº‘ã€‚è¨€è€Œæ€»ä¹‹ï¼Œè¿™æœ¬ä¹¦åº”è¯¥ç›¸å½“é€‚åˆåˆå…¥èŒåœº/å°šæœªå½¢æˆä¸ªäººä»£ç é£æ ¼/è¯»åˆ°å±å±±ä¸æ˜¯é€‰æ‹©å«æ³ªç”Ÿåè€Œæ˜¯æƒ³æŠŠå§‹ä½œä¿‘è€…æ´»å‰¥/ä¸€ä¸ªæœ‰å…¬å¾·å¿ƒçš„ä»£ç è´¡çŒ®è€…çš„fresh coderã€‚</p>
<a id="more"></a>
<p>åœ¨å¼€å§‹è¯»ä¹¦ä¹‹å‰ï¼Œä¸å¦¨å…ˆå»ç®€å•å’Œä½œè€…æ‰“ä¸ªç…§é¢ï½<br><a href="https://martinfowler.com" target="_blank" rel="noopener">Martin Fowler</a><br>ğŸ”œä¸ªäººå®˜æ–¹ç½‘ç«™çš„Nav Barå¯ä»¥å¿«é€Ÿè·å¾—ä»–ä½œä¸ºæŠ€æœ¯äººå‘˜çš„å‡ ä¸ªå…³é”®è¯ï¼Œ<em>Refractoring</em>, <em>Agile</em>, <em>Architecture</em>,<em>Thoughtworks_ã€‚è€Œåœ¨ç½‘ç«™ç»¼è¿°ä¸­ï¼Œé«˜äº®æ–‡æœ¬è¿›ä¸€æ­¥å›Šæ‹¬äº†_MicroService</em>,<em>Testing</em>,_Continuous Delivery_ã€‚æ­é…ç€profile photoä¸­ç”‘å…‰ç“¦äº®çš„è„‘é—¨å’Œä¸ä¿®è¾¹å¹…çš„èƒ¡èŒ¬ï¼Œä½œè€…ç•™ç»™æˆ‘çš„ç¬¬ä¸€å°è±¡æ˜¯ä¸€ä½å¯¹æŠ€æœ¯æœ‰åæ‰§è¿½æ±‚çš„ï¼Œä¸¥è°¨è€Œä¹äºå¥‰çŒ®çš„ä¸šç•Œå‰è¾ˆã€‚More codeful, more hairlessã€‚<br>è€Œåœ¨é˜…è¯»å®Œæœ¬ä¹¦çš„ç¬¬ä¸€ç« åï¼Œæˆ‘æ›´åŠ å‘ç°ä»–æ˜¯ä¸€ä¸ªå‡ºè‰²çš„å†…å®¹æ’°å†™è€…å’ŒçŸ¥è¯†åˆ†äº«è€…ã€‚å¾ˆå¤šè¿‡å¾€é˜…è¯»çš„æŠ€æœ¯ç±»ä¹¦ç±ï¼ŒåŒ…æ‹¬Oâ€™Reillyåœ¨å†…ï¼Œä½œè€…è¾“å‡ºäº†å¾ˆå¤šé«˜å±‹å»ºç“´çš„è§‚ç‚¹ï¼Œä½†æ˜¯é€‰å–çš„ä¾‹å­å´å¾€å¾€æ˜¾å¾—ç‰‡é¢/æ²¡æœ‰ä»£è¡¨æ€§/æ²¡æœ‰å¯å®ç°æ€§ã€‚å°±æˆ‘ä¸ªäººè€Œè¨€ï¼ŒåŠ¨æ‰‹å®æˆ˜+è¿‡ç¨‹åæ€å¾€å¾€æ˜¯æ¶ˆåŒ–çŸ¥è¯†æœ€æœ‰æ•ˆçš„æ–¹å¼ï¼Œæ²¡æœ‰è‡ªæˆ‘å‚ä¸çš„æŠ€æœ¯ä¹¦ç±é˜…è¯»å°±åƒæ˜¯å¤•é˜³ä¸‹çš„å¥”è·‘ï¼Œä½ çœ‹ç€ä½œè€…çš„å½±å­åœ¨å¤•é˜³ä¸‹è¶Šæ‹‰è¶Šé•¿ï¼Œæœ€åæ¶ˆå¤±åœ¨åœ°å¹³çº¿ï¼Œå¾’ç•™ä¸€é˜µæƒ˜ç„¶è‹¥å¤±ã€‚è€Œä¹‹æ‰€ä»¥æ•¬ä½©æœ¬ä¹¦ä½œè€…çš„åŸå› ï¼Œæ­£æ˜¯åœ¨äºä»ç¬¬ä¸€ç« çš„é€‰ä¾‹è®²è§£ä¸­ï¼Œä½ å¯ä»¥çœ‹åˆ°ä¸€ä¸ªç²¾ç»†çš„é«˜å¯†åº¦åˆ°ä½å¯†åº¦çš„çŸ¥è¯†æ¸—é€è¿‡ç¨‹ï¼Œè€Œä¸æ˜¯çŸ¥è¯†æ³„æ´ªï¼Œä½œè€…å°½å¯èƒ½åœ°æŠŠæ¯ä¸€å°æ­¥é‡æ„çš„å˜åŠ¨éƒ½è½¬åŒ–ä¸ºä»£ç ï¼Œå¹¶ç”¨ä¸åŒçš„å­—ä½“æ ‡æ³¨äº†æœ‰å˜åŠ¨çš„åœ°æ–¹ï¼Œä»¥ä¿è¯è¯»è€…èƒ½å¤Ÿè·Ÿå¾—ä¸Šè¿›åº¦ã€‚</p>
<h1 id="ç¬¬ä¸€ç« -é‡æ„ï¼Œç¬¬ä¸€ä¸ªç¤ºä¾‹"><a href="#ç¬¬ä¸€ç« -é‡æ„ï¼Œç¬¬ä¸€ä¸ªç¤ºä¾‹" class="headerlink" title="ç¬¬ä¸€ç«  é‡æ„ï¼Œç¬¬ä¸€ä¸ªç¤ºä¾‹"></a>ç¬¬ä¸€ç«  é‡æ„ï¼Œç¬¬ä¸€ä¸ªç¤ºä¾‹</h1><p>åœ¨è¿™ä¸€ç« ä½œè€…å¼•å…¥äº†ä¸€ä¸ªä¾‹å­ç”¨äºè¯´æ˜</p>
<ul>
<li>Why We Need Refactoring</li>
<li>How We Implement Refactoring<br><img src="https://upload-images.jianshu.io/upload_images/15098936-46dea6b1bf5c81d7.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="Code Refactoring - Performance Audience Credit.png"></li>
</ul>
<p>okï¼Œæˆ‘æœ¬èº«å¯¹jså¹¶ä¸æ˜¯éå¸¸ç†Ÿæ‚‰ï¼Œå°±ç®€å•ç”¨WebStormå®ç°äº†ä¸€ä¸‹jsçš„é€»è¾‘ã€‚å½“ç„¶è¯šå¦‚ä½œè€…æ‰€è¨€ï¼Œè¯­è¨€æ›´å¤šçš„åªæ˜¯è½½ä½“ï¼Œåœ¨æœ¬ä¹¦ç¬¬ä¸€ç‰ˆä¸­javaæ˜¯ä¸»è¦çš„é€»è¾‘è½½ä½“ã€‚ä¸‹é¢çš„ä»£ç æ‰“å°äº†å®¢æˆ·çš„ç”¨æˆ·ç§¯åˆ†ï¼Œä½œè€…ç»™å‡ºè¿™ä¸€ç‰ˆç²—ç²çš„ä»£ç æƒ³è¦å±•ç¤ºå¦‚ä½•é€šè¿‡é‡æ„æŠ€å·§ï¼Œæé«˜ä»£ç çš„å¯æ‹“å±•æ€§å’Œå¯è¯»æ€§ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line">let plays &#x3D; &#123;</span><br><span class="line">    &quot;hamlet&quot;: &#123;&quot;name&quot;: &quot;Hamlet&quot;, &quot;type&quot;: &quot;tragedy&quot;&#125;,</span><br><span class="line">    &quot;as-like&quot;: &#123;&quot;name&quot;: &quot;As You Like It&quot;, &quot;type&quot;: &quot;comedy&quot;&#125;,</span><br><span class="line">    &quot;othello&quot;: &#123;&quot;name&quot;: &quot;Othello&quot;, &quot;type&quot;: &quot;tragedy&quot;&#125;</span><br><span class="line">&#125;</span><br><span class="line">let invoices &#x3D; [</span><br><span class="line">    &#123;</span><br><span class="line">        &quot;customer&quot;: &quot;BigCo&quot;,</span><br><span class="line">        &quot;performances&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">                &quot;playID&quot;: &quot;hamlet&quot;,</span><br><span class="line">                &quot;audience&quot;: 55</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                &quot;playID&quot;: &quot;as-like&quot;,</span><br><span class="line">                &quot;audience&quot;: 35</span><br><span class="line">            &#125;,</span><br><span class="line">            &#123;</span><br><span class="line">                &quot;playID&quot;: &quot;othello&quot;,</span><br><span class="line">                &quot;audience&quot;: 40</span><br><span class="line">            &#125;</span><br><span class="line">        ]</span><br><span class="line">    &#125;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">function statement (invoice, plays) &#123;</span><br><span class="line">    let totalAmount &#x3D; 0;</span><br><span class="line">    let volumeCredits &#x3D; 0;</span><br><span class="line">    let result &#x3D; &#96;Statement for $&#123;invoice.customer&#125;\n&#96;;</span><br><span class="line">    const format &#x3D; new Intl.NumberFormat(&quot;en-US&quot;,</span><br><span class="line">        &#123; style: &quot;currency&quot;, currency: &quot;USD&quot;,</span><br><span class="line">            minimumFractionDigits: 2 &#125;).format;</span><br><span class="line"></span><br><span class="line">    for (let perf of invoice.performances) &#123;</span><br><span class="line">        const play &#x3D; plays[perf.playID];</span><br><span class="line">        let thisAmount &#x3D; 0;</span><br><span class="line"></span><br><span class="line">        switch (play.type) &#123;</span><br><span class="line">            case &quot;tragedy&quot;:</span><br><span class="line">                thisAmount &#x3D; 40000;</span><br><span class="line">                if (perf.audience &gt; 30) &#123;</span><br><span class="line">                    thisAmount +&#x3D; 1000 * (perf.audience - 30);</span><br><span class="line">                &#125;</span><br><span class="line">                break;</span><br><span class="line">            case &quot;comedy&quot;:</span><br><span class="line">                thisAmount &#x3D; 30000;</span><br><span class="line">                if (perf.audience &gt; 20) &#123;</span><br><span class="line">                    thisAmount +&#x3D; 10000 + 500 * (perf.audience - 20);</span><br><span class="line">                &#125;</span><br><span class="line">                thisAmount +&#x3D; 300 * perf.audience;</span><br><span class="line">                break;</span><br><span class="line">            default:</span><br><span class="line">                throw new Error(&#96;unknown type: $&#123;play.type&#125;&#96;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; add volume credits</span><br><span class="line">        volumeCredits +&#x3D; Math.max(perf.audience - 30, 0);</span><br><span class="line">        &#x2F;&#x2F; add extra credit for every ten comedy attendees</span><br><span class="line">        if (&quot;comedy&quot; &#x3D;&#x3D;&#x3D; play.type) volumeCredits +&#x3D; Math.floor(perf.audience &#x2F; 5);</span><br><span class="line"></span><br><span class="line">        &#x2F;&#x2F; print line for this order</span><br><span class="line">        result +&#x3D; &#96;  $&#123;play.name&#125;: $&#123;format(thisAmount&#x2F;100)&#125; ($&#123;perf.audience&#125; seats)\n&#96;;</span><br><span class="line">        totalAmount +&#x3D; thisAmount;</span><br><span class="line">    &#125;</span><br><span class="line">    result +&#x3D; &#96;Amount owed is $&#123;format(totalAmount&#x2F;100)&#125;\n&#96;;</span><br><span class="line">    result +&#x3D; &#96;You earned $&#123;volumeCredits&#125; credits\n&#96;;</span><br><span class="line">    return result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">console.log(statement(invoices[0], plays));</span><br></pre></td></tr></table></figure>
<p>è¾“å‡º</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Statement for BigCo</span><br><span class="line">  Hamlet: $650.00 (55 seats)</span><br><span class="line">  As You Like It: $580.00 (35 seats)</span><br><span class="line">  Othello: $500.00 (40 seats)</span><br><span class="line">Amount owed is $1,730.00</span><br><span class="line">You earned 47 credits</span><br></pre></td></tr></table></figure>
<p>é¦–å…ˆå¾—æ‰¿è®¤è¿™æ®µä»£ç æ˜¯ä¸€é¢—é¡½çŸ³ï¼Œä»…å°±å­¦ä¹ è¿‡çš„è®¾è®¡æ–¹æ³•è€Œè¨€ï¼Œè¿™æ®µä»£ç æ˜¾è€Œæ˜“è§åœ°ä¸æ»¡è¶³å¼€é—­åŸåˆ™ï¼Œè¿™å°±è¦æ±‚å¯¹å…¬å…±ä»£ç è¿›è¡ŒæŠ½è±¡ï¼Œè€ŒåŸºäºå•ä¸€èŒè´£åŸåˆ™ï¼Œè¿™ä¸ªæ–¹æ³•å†—æ‚äº†å¤ªå¤šçš„ä¸šåŠ¡é€»è¾‘ï¼ŒåŒ…æ‹¬è´¹ç”¨çš„è®¡ç®—å’Œç§¯åˆ†çš„è®¡ç®—åŠŸèƒ½å’Œæ‰“å°è®°å½•å¯è§†åŒ–çš„åŠŸèƒ½ã€‚<br>é‚£ä¹ˆåœ¨æ²¡æœ‰è¿›ä¸€æ­¥å­¦ä¹ ä½œè€…çš„ä¸“ä¸šæŠ€å·§ä¹‹å‰ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•åœ°å°è¯•è‡ªè¡Œé‡æ„è¿™æ®µä»£ç ã€‚</p>
<ul>
<li>å¯¹è´¹ç”¨è®¡ç®—è¿›è¡Œæ•´åˆ<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line">function statement (invoice, plays) &#123;</span><br><span class="line">    let totalAmount &#x3D; 0;</span><br><span class="line">    let volumeCredits &#x3D; 0;</span><br><span class="line">    let result &#x3D; &#96;Statement for $&#123;invoice.customer&#125;\n&#96;;</span><br><span class="line">    </span><br><span class="line">    for (let perf of invoice.performances) &#123;</span><br><span class="line">        let thisAmount &#x3D; 0;</span><br><span class="line">        thisAmount &#x3D; getAmount(perf);</span><br><span class="line">        &#x2F;&#x2F; add volume credits</span><br><span class="line">        volumeCredits +&#x3D; calcAudCredit(perf);</span><br><span class="line">        &#x2F;&#x2F; print line for this order</span><br><span class="line">        result +&#x3D; &#96;  $&#123;getPlayFromPerf(perf).name&#125;: $&#123;usdFormat(thisAmount&#x2F;100)&#125; ($&#123;perf.audience&#125; seats)\n&#96;;</span><br><span class="line">        totalAmount +&#x3D; thisAmount;</span><br><span class="line">    &#125;</span><br><span class="line">    result +&#x3D; &#96;Amount owed is $&#123;usdFormat(totalAmount&#x2F;100)&#125;\n&#96;;</span><br><span class="line">    result +&#x3D; &#96;You earned $&#123;volumeCredits&#125; credits\n&#96;;</span><br><span class="line">    return result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function usdFormat(amount) &#123;</span><br><span class="line">    return new Intl.NumberFormat(&quot;en-US&quot;,</span><br><span class="line">        &#123; style: &quot;currency&quot;, currency: &quot;USD&quot;,</span><br><span class="line">            minimumFractionDigits: 2 &#125;).format(amount);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function calcAudCredit(perf) &#123;</span><br><span class="line">    let volumeCredits &#x3D; 0;</span><br><span class="line">    volumeCredits &#x3D; Math.max(perf.audience - 30, 0);</span><br><span class="line">    &#x2F;&#x2F; add extra credit for every ten comedy attendees</span><br><span class="line">    if (&quot;comedy&quot; &#x3D;&#x3D;&#x3D; getPlayFromPerf(perf).type) volumeCredits +&#x3D; Math.floor(perf.audience &#x2F; 5);</span><br><span class="line">    return volumeCredits;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function getPlayFromPerf(perf) &#123;</span><br><span class="line">    return plays[perf.playID];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">function getAmount(perf) &#123;</span><br><span class="line">    let amount &#x3D; 0;</span><br><span class="line">    let play &#x3D; getPlayFromPerf(perf);</span><br><span class="line">    switch (play.type) &#123;</span><br><span class="line">        case &quot;tragedy&quot;:</span><br><span class="line">            amount &#x3D; 40000;</span><br><span class="line">            if (perf.audience &gt; 30) &#123;</span><br><span class="line">                amount +&#x3D; 1000 * (perf.audience - 30);</span><br><span class="line">            &#125;</span><br><span class="line">            return amount;</span><br><span class="line">        case &quot;comedy&quot;:</span><br><span class="line">            amount &#x3D; 30000;</span><br><span class="line">            if (perf.audience &gt; 20) &#123;</span><br><span class="line">                amount +&#x3D; 10000 + 500 * (perf.audience - 20);</span><br><span class="line">            &#125;</span><br><span class="line">            amount +&#x3D; 300 * perf.audience;</span><br><span class="line">            return amount;</span><br><span class="line">        default:</span><br><span class="line">            throw new Error(&#96;unknown type: $&#123;play.type&#125;&#96;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
ç¬¬ä¸€æ­¥æˆ‘çš„æƒ³æ³•æ˜¯å°†ä¸šåŠ¡åŠŸèƒ½ä¸åŒçš„é€»è¾‘å—å°½å¯èƒ½æŠ½è±¡æˆæ–¹æ³•ï¼Œä¸»é€»è¾‘ä¸­åªé€šè¿‡è°ƒç”¨æ–¹æ³•è¡¨å¾ä¸šåŠ¡é€»è¾‘ã€‚<br>ä¸‹ä¸€æ­¥ä½¿æ–¹æ³•èƒ½å¤Ÿé¢å‘æ–°çš„éœ€æ±‚ï¼Œæ¯”å¦‚</li>
<li>é©¬æˆå›¢æä¾›äº†æ›´å¤šç§ç±»çš„æˆå‰§ï¼Œå…¶è´¹ç”¨å’Œç”¨æˆ·ç§¯åˆ†çš„è®¡ç®—é€»è¾‘ç›¸åº”åœ°æ”¹å˜</li>
<li>è¾“å‡ºæ ¼å¼æœ‰å˜æ›´çš„éœ€æ±‚ï¼Œæ¯”å¦‚æ–°çš„æ–‡æœ¬æ ¼å¼/æ–°çš„è´§å¸å•ä½<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line">function statement (invoice, plays) &#123;</span><br><span class="line">    let activityData &#x3D; &#123;&#125;;</span><br><span class="line">    initData(activityData, invoice);</span><br><span class="line">    let result &#x3D; &#96;Statement for $&#123;invoice.customer&#125;\n&#96;;</span><br><span class="line"></span><br><span class="line">    for (let perf of invoice.performances) &#123;</span><br><span class="line">        enforceData(activityData, enforcePerformance(perf));</span><br><span class="line">        &#x2F;&#x2F; print line for this order</span><br><span class="line">        result +&#x3D; &#96;  $&#123;perf.play.name&#125;: $&#123;usdFormat(perf.amount &#x2F; 100)&#125; ($&#123;perf.audience&#125; seats)\n&#96;;</span><br><span class="line">    &#125;</span><br><span class="line">    result +&#x3D; &#96;Amount owed is $&#123;usdFormat(activityData.totalAmount &#x2F; 100)&#125;\n&#96;;</span><br><span class="line">    result +&#x3D; &#96;You earned $&#123;activityData.volumeCredits&#125; credits\n&#96;;</span><br><span class="line">    return result;</span><br><span class="line"></span><br><span class="line">    function initData(activityData, invoice) &#123;</span><br><span class="line">        activityData.totalAmount &#x3D; 0;</span><br><span class="line">        activityData.volumeCredits &#x3D; 0;</span><br><span class="line">        activityData.invoice &#x3D; JSON.parse(JSON.stringify(invoice));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function usdFormat(amount) &#123;</span><br><span class="line">        return new Intl.NumberFormat(&quot;en-US&quot;,</span><br><span class="line">            &#123;</span><br><span class="line">                style: &quot;currency&quot;, currency: &quot;USD&quot;,</span><br><span class="line">                minimumFractionDigits: 2</span><br><span class="line">            &#125;).format(amount);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function enforceData(activityData, perf) &#123;</span><br><span class="line">        activityData.totalAmount +&#x3D; perf.amount;</span><br><span class="line">        activityData.volumeCredits +&#x3D; perf.audCredit;</span><br><span class="line">        return activityData;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function enforcePerformance(perf) &#123;</span><br><span class="line">        perf.calculator &#x3D; buildCalculator(perf);</span><br><span class="line">        perf.play &#x3D; getPlayFromPerf(perf);</span><br><span class="line">        perf.amount &#x3D; perf.calculator.getAmount();</span><br><span class="line">        perf.audCredit &#x3D; perf.calculator.calcAudCredit();</span><br><span class="line">        return perf;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function getPlayFromPerf(perf) &#123;</span><br><span class="line">        return plays[perf.playID];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    function buildCalculator(perf) &#123;</span><br><span class="line">        switch (getPlayFromPerf(perf).type) &#123;</span><br><span class="line">            case &quot;tragedy&quot;:</span><br><span class="line">                return new TragetyCalculator(perf);</span><br><span class="line">            case &quot;comedy&quot;:</span><br><span class="line">                return new ComedyCalculator(perf);</span><br><span class="line">            default:</span><br><span class="line">                throw new Error(&#96;unknown type: $&#123;getPlayFromPerf(perf).type&#125;&#96;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class OperaCalculator &#123;</span><br><span class="line">    constructor(perf) &#123;</span><br><span class="line">        this.perf &#x3D; perf;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    getAmount() &#123;</span><br><span class="line">        return 0;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    calcAudCredit() &#123;</span><br><span class="line">        return Math.max(this.perf.audience - 30, 0);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class ComedyCalculator extends OperaCalculator &#123;</span><br><span class="line">    getAmount() &#123;</span><br><span class="line">        let amount &#x3D; 30000;</span><br><span class="line">        if (this.perf.audience &gt; 20) &#123;</span><br><span class="line">            amount +&#x3D; 10000 + 500 * (this.perf.audience - 20);</span><br><span class="line">        &#125;</span><br><span class="line">        amount +&#x3D; 300 * this.perf.audience;</span><br><span class="line">        return amount;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    calcAudCredit() &#123;</span><br><span class="line">        return super.calcAudCredit() + Math.floor(this.perf.audience &#x2F; 5);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class TragetyCalculator extends OperaCalculator &#123;</span><br><span class="line">    getAmount() &#123;</span><br><span class="line">        let amount &#x3D; 40000;</span><br><span class="line">        if (this.perf.audience &gt; 30) &#123;</span><br><span class="line">            amount +&#x3D; 1000 * (this.perf.audience - 30);</span><br><span class="line">        &#125;</span><br><span class="line">        return amount;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
åœ¨ä¸Šé¢çš„ä»£ç ä¸­æˆ‘æŠŠæ•°å€¼è®¡ç®—éƒ¨åˆ†æŠ½è±¡åˆ°å¯ç»§æ‰¿çš„è®¡ç®—å™¨ç±»ä¸­ï¼Œä»è€Œå®ç°äº†å¯æ‹“å±•ã€‚åŒæ—¶å¯¹æœ‰ä»å±å…³ç³»çš„å˜é‡è¿›è¡Œæ¨¡å‹åŒ–æ•´åˆï¼Œè¿™æ ·ä¸€æ¥è¿›ä¸€æ­¥å‡å°‘äº†ä¸»æ–¹æ³•statement()ä¸­çš„é€»è¾‘è¡¨è¾¾ï¼Œé¡¶å±‚æ–¹æ³•é¢å‘æŠ½è±¡çš„pojoè€Œä¸æ˜¯å…·ä½“å‚æ•°ã€‚é¡ºå¸¦ä¸€æï¼Œåœ¨å®ä¾‹ä¼ é€’æ—¶å°½å¯èƒ½é¿å…ä¿®æ”¹åŸå®ä¾‹ä¸­çš„å€¼ï¼Œå½“ç„¶è¿™ä¼šé€ æˆä¸€å®šçš„å†…å­˜æ¶ˆè€—ï¼Œåœ¨ä»£ç ä¸­ç”±äºä¼ é€’çš„ç±»å‹æ¯”è¾ƒç®€å•æˆ‘ç›´æ¥ä½¿ç”¨äº†<code>JSON.parse(JSON.stringify(invoice))</code><br>çš„æ·±å¤åˆ¶æ–¹æ³•ï¼Œå¦‚æœéœ€è¦é€‚é…å¤šç§æ•°æ®ç±»å‹ï¼Œæœ€å¥½å»äº†è§£ä¸€ä¸‹jQueryæˆ–å…¶ä»–æ¡†æ¶æ˜¯å¦‚ä½•å®ç°æ·±å¤åˆ¶çš„ã€‚<br>å½“é‡æ„æ¥åˆ°è¿™é‡Œæˆ‘æ„Ÿè§‰é‡åˆ°äº†ç“¶é¢ˆï¼Œæ‰“å°éƒ¨åˆ†çš„ä»£ç è€¦åˆåœ¨äº†å¾ªç¯ä½“é‡Œï¼Œåˆå¹¶ä¹‹å‰å¿…é¡»è¿›è¡Œæ‹†åˆ†ï¼Œè¿™æ ·ä¸€æ¥å°±ä¸å¾—ä¸åœ¨ä»£ç ä¸­è¿›è¡Œä¸¤æ¬¡å¾ªç¯ã€‚è¿™å¯èƒ½å°±æ˜¯é‡æ„å’Œæ€§èƒ½çš„_trade-off_ï¼Œçœ‹äº†ä½œè€…çš„å¤„ç†ï¼Œä¹Ÿæ˜¯å°†è¿™éƒ¨åˆ†é€»è¾‘ä»å¾ªç¯ä½“ä¸­å‰¥ç¦»ä»è€Œç»„è£…æˆä¸€ä¸ªå®Œæ•´çš„æ‰“å°æ–¹æ³•ï¼Œè¯šç„¶å¯¹äºè¿™ä¸ªåŠŸèƒ½è€Œè¨€å¢åŠ ä¸€ä¸ªå¾ªç¯ä½“é€ æˆçš„æ—¶é—´æŸè€—å¾®ä¹å…¶å¾®ï¼Œä½†æ¯•ç«Ÿæ€§èƒ½ä¼˜åŒ–å¹¶éé‡æ„çš„é¦–è¦è€ƒé‡ï¼Œæˆ‘è®¤ä¸ºé‡æ„æ˜¯é¢å‘ä¸šåŠ¡æ‰©å±•å’Œé¢å‘å¯æŒç»­äº¤ä»˜çš„ã€‚å› æ­¤ï¼Œåœ¨æ€§èƒ½ä¸é‡æ„äº¤é”‹å¤„ç•™ä¸€ä¸ªå¿ƒçœ¼ï¼Œå¾€å¾€ä¹Ÿä¸æ˜¯ä»€ä¹ˆåäº‹ã€‚<h2 id="åŸä¹¦å®ç°"><a href="#åŸä¹¦å®ç°" class="headerlink" title="åŸä¹¦å®ç°"></a>åŸä¹¦å®ç°</h2>statement.js<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">import createStatementData from &#39;.&#x2F;createStatementData.js&#39;;</span><br><span class="line">  function statement (invoice, plays) &#123;</span><br><span class="line">    return renderPlainText(createStatementData(invoice, plays));</span><br><span class="line">  &#125;</span><br><span class="line">  function renderPlainText(data, plays) &#123;</span><br><span class="line">    let result &#x3D; &#96;Statement for $&#123;data.customer&#125;\n&#96;;</span><br><span class="line">    for (let perf of data.performances) &#123;</span><br><span class="line">      result +&#x3D; &#96;  $&#123;perf.play.name&#125;: $&#123;usd(perf.amount)&#125; ($&#123;perf.audience&#125; seats)\n&#96;;</span><br><span class="line">    &#125;</span><br><span class="line">    result +&#x3D; &#96;Amount owed is $&#123;usd(data.totalAmount)&#125;\n&#96;;</span><br><span class="line">    result +&#x3D; &#96;You earned $&#123;data.totalVolumeCredits&#125; credits\n&#96;;</span><br><span class="line">    return result;</span><br><span class="line">  &#125;</span><br><span class="line">  function htmlStatement (invoice, plays) &#123;</span><br><span class="line">    return renderHtml(createStatementData(invoice, plays));</span><br><span class="line">  &#125;</span><br><span class="line">  function renderHtml (data) &#123;</span><br><span class="line">    let result &#x3D; &#96;&lt;h1&gt;Statement for $&#123;data.customer&#125;&lt;&#x2F;h1&gt;\n&#96;;</span><br><span class="line">    result +&#x3D; &quot;&lt;table&gt;\n&quot;;</span><br><span class="line">    result +&#x3D; &quot;&lt;tr&gt;&lt;th&gt;play&lt;&#x2F;th&gt;&lt;th&gt;seats&lt;&#x2F;th&gt;&lt;th&gt;cost&lt;&#x2F;th&gt;&lt;&#x2F;tr&gt;&quot;;</span><br><span class="line">    for (let perf of data.performances) &#123;</span><br><span class="line">      result +&#x3D; &#96;  &lt;tr&gt;&lt;td&gt;$&#123;perf.play.name&#125;&lt;&#x2F;td&gt;&lt;td&gt;$&#123;perf.audience&#125;&lt;&#x2F;td&gt;&#96;;</span><br><span class="line">      result +&#x3D; &#96;&lt;td&gt;$&#123;usd(perf.amount)&#125;&lt;&#x2F;td&gt;&lt;&#x2F;tr&gt;\n&#96;;</span><br><span class="line">    &#125;</span><br><span class="line">    result +&#x3D; &quot;&lt;&#x2F;table&gt;\n&quot;;</span><br><span class="line">    result +&#x3D; &#96;&lt;p&gt;Amount owed is &lt;em&gt;$&#123;usd(data.totalAmount)&#125;&lt;&#x2F;em&gt;&lt;&#x2F;p&gt;\n&#96;;</span><br><span class="line">    result +&#x3D; &#96;&lt;p&gt;You earned &lt;em&gt;$&#123;data.totalVolumeCredits&#125;&lt;&#x2F;em&gt; credits&lt;&#x2F;p&gt;\n&#96;;</span><br><span class="line">    return result;</span><br><span class="line">  &#125;</span><br><span class="line">  function usd(aNumber) &#123;</span><br><span class="line">    return new Intl.NumberFormat(&quot;en-US&quot;,</span><br><span class="line">                                 &#123; style: &quot;currency&quot;, currency: &quot;USD&quot;,</span><br><span class="line">                                   minimumFractionDigits: 2 &#125;).format(aNumber&#x2F;100);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
createStatementData.js<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">export default function createStatementData(invoice, plays) &#123;</span><br><span class="line">    const result &#x3D; &#123;&#125;;</span><br><span class="line">    result.customer &#x3D; invoice.customer;</span><br><span class="line">    result.performances &#x3D; invoice.performances.map(enrichPerformance);</span><br><span class="line">    result.totalAmount &#x3D; totalAmount(result);</span><br><span class="line">    result.totalVolumeCredits &#x3D; totalVolumeCredits(result);</span><br><span class="line">    return result;</span><br><span class="line">  </span><br><span class="line">    function enrichPerformance(aPerformance) &#123;</span><br><span class="line">      const calculator &#x3D; createPerformanceCalculator(aPerformance, playFor(aPerformance));</span><br><span class="line">      const result &#x3D; Object.assign(&#123;&#125;, aPerformance);</span><br><span class="line">      result.play &#x3D; calculator.play;</span><br><span class="line">      result.amount &#x3D; calculator.amount;</span><br><span class="line">      result.volumeCredits &#x3D; calculator.volumeCredits;</span><br><span class="line">      return result;</span><br><span class="line">    &#125;</span><br><span class="line">    function playFor(aPerformance) &#123;</span><br><span class="line">      return plays[aPerformance.playID]</span><br><span class="line">    &#125;</span><br><span class="line">    function totalAmount(data) &#123;</span><br><span class="line">      return data.performances</span><br><span class="line">        .reduce((total, p) &#x3D;&gt; total + p.amount, 0);</span><br><span class="line">    &#125;</span><br><span class="line">    function totalVolumeCredits(data) &#123;</span><br><span class="line">      return data.performances</span><br><span class="line">        .reduce((total, p) &#x3D;&gt; total + p.volumeCredits, 0);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  function createPerformanceCalculator(aPerformance, aPlay) &#123;</span><br><span class="line">      switch(aPlay.type) &#123;</span><br><span class="line">      case &quot;tragedy&quot;: return new TragedyCalculator(aPerformance, aPlay);</span><br><span class="line">      case &quot;comedy&quot; : return new ComedyCalculator(aPerformance, aPlay);</span><br><span class="line">      default:</span><br><span class="line">          throw new Error(&#96;unknown type: $&#123;aPlay.type&#125;&#96;);</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  class PerformanceCalculator &#123;</span><br><span class="line">    constructor(aPerformance, aPlay) &#123;</span><br><span class="line">      this.performance &#x3D; aPerformance;</span><br><span class="line">      this.play &#x3D; aPlay;</span><br><span class="line">    &#125;</span><br><span class="line">    get amount() &#123;</span><br><span class="line">      throw new Error(&#39;subclass responsibility&#39;);</span><br><span class="line">    &#125;</span><br><span class="line">    get volumeCredits() &#123;</span><br><span class="line">      return Math.max(this.performance.audience - 30, 0);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  class TragedyCalculator extends PerformanceCalculator &#123;</span><br><span class="line">    get amount() &#123;</span><br><span class="line">      let result &#x3D; 40000;</span><br><span class="line">      if (this.performance.audience &gt; 30) &#123;</span><br><span class="line">        result +&#x3D; 1000 * (this.performance.audience - 30);</span><br><span class="line">      &#125;</span><br><span class="line">      return result;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  class ComedyCalculator extends PerformanceCalculator &#123;</span><br><span class="line">    get amount() &#123;</span><br><span class="line">      let result &#x3D; 30000;</span><br><span class="line">      if (this.performance.audience &gt; 20) &#123;</span><br><span class="line">        result +&#x3D; 10000 + 500 * (this.performance.audience - 20);</span><br><span class="line">      &#125;</span><br><span class="line">      result +&#x3D; 300 * this.performance.audience;</span><br><span class="line">      return result;</span><br><span class="line">    &#125;</span><br><span class="line">    get volumeCredits() &#123;</span><br><span class="line">      return super.volumeCredits + Math.floor(this.performance.audience &#x2F; 5);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<h2 id="ç¬¬ä¸€ç« æ€»ç»“"><a href="#ç¬¬ä¸€ç« æ€»ç»“" class="headerlink" title="ç¬¬ä¸€ç« æ€»ç»“"></a>ç¬¬ä¸€ç« æ€»ç»“</h2>æœ¬ç« ä¸­ä½œè€…é‡‡ç”¨çš„é‡æ„æ‰‹æ³•æœ‰ï¼š</li>
<li><a href="https://memberservices.informit.com/my_account/webedition/9780135425664/html/extractfunction.html" target="_blank" rel="noopener">æç‚¼å‡½æ•° Extract Function</a></li>
<li><a href="https://memberservices.informit.com/my_account/webedition/9780135425664/html/inlinevariable.html" target="_blank" rel="noopener">å†…è”å˜é‡ Inline Variable</a></li>
<li><a href="https://memberservices.informit.com/my_account/webedition/9780135425664/html/movefunction.html" target="_blank" rel="noopener">æ¬ç§»å‡½æ•° Move Function</a></li>
<li><a href="https://memberservices.informit.com/my_account/webedition/9780135425664/html/replaceconditionalwithpolymorphism.html" target="_blank" rel="noopener">ä»¥å¤šæ€å–ä»£æ¡ä»¶è¡¨è¾¾å¼ Replace Conditional with Polymorphism</a><br>é“¾æ¥æŒ‡å‘åŸä¹¦ç½‘é¡µç‰ˆå¯¹è¿™äº›åè¯çš„å›¾æ–‡è§£é‡Š<br>å¯¹æ¯”ä½œè€…çš„é‡æ„æ‰‹æ³•å’Œä¸ªäººçš„ï¼Œä¸éš¾å‘ç°ï¼Œé‡æ„æ›´å¤šæ˜¯coderåŸºå› é‡Œå†³å®šçš„ä¸œè¥¿ã€‚æ›´å‡†ç¡®åœ°è¯´ï¼Œæ˜¯äººç±»å¤§è„‘å¯¹æ›´å…·ç»„ç»‡åŒ–çš„å¯¹è±¡çš„ç†è§£æœ¬èƒ½ï¼Œé©±åŠ¨ç€æˆ‘ä»¬å»å¯¹ä»£ç è¿›è¡Œé‡æ„ã€‚è¿™ç§è¡Œä¸ºä½“ç°åœ¨ç®€å•çš„äº‹ç‰©ä¸Šä½ å¾ˆéš¾å»åŒºåˆ†å…¶ç©¶ç«Ÿæ˜¯æœ¬èƒ½é©±åŠ¨è¿˜æ˜¯ä¾æ®äº†æŸç§çº²é¢†ï¼Œä½†åœ¨å¤„ç†å¤æ‚çš„é€»è¾‘æ—¶ï¼Œä½ æ€»èƒ½å‘ç°æœ‰æ³•å¯å¾ªçš„å¥½å¤„ã€‚<br>é‚£ä¹ˆæ€»ç»“ä¸€ä¸‹ä½œè€…é‡‡å–çš„<strong><em>ä¸‰ä¸ªé‡æ„æ­¥éª¤</em></strong>ï¼š</li>
</ul>
<ol>
<li>å°†åŸå‡½æ•°æ‹†åˆ†æˆä¸€ç»„åµŒå¥—çš„å‡½æ•°</li>
<li>é‡‡ç”¨<a href="https://memberservices.informit.com/my_account/webedition/9780135425664/html/splitphase.html" target="_blank" rel="noopener">æ‹†åˆ†é˜¶æ®µ Split Phase</a>åˆ†ç¦»è®¡ç®—é€»è¾‘å’Œæ ¼å¼åŒ–è¾“å‡º</li>
<li>ä¸ºè®¡ç®—å™¨å¼•å…¥å¤šæ€æ€§å¤„ç†è®¡ç®—é€»è¾‘</li>
</ol>
<h1 id="ç¬¬äºŒç« -é‡æ„çš„åŸåˆ™"><a href="#ç¬¬äºŒç« -é‡æ„çš„åŸåˆ™" class="headerlink" title="ç¬¬äºŒç«  é‡æ„çš„åŸåˆ™"></a>ç¬¬äºŒç«  é‡æ„çš„åŸåˆ™</h1><p>è¿™ä¸¤å¤©å¿™ç€ç»´æŠ¤github pageäº†ï¼Œç»“æœå†è¯»ç¬¬äºŒç« å°±å·²ç»æ˜¯ä¸¤å¤©åçš„äº‹æƒ…äº†ã€‚ç¬¬äºŒç« ä½œè€…è¯´æ˜äº†<strong>ä½•ä¸ºé‡æ„</strong>ï¼Œ<strong>ä¸ºä½•é‡æ„</strong>å’Œ<strong>ä½•æ—¶é‡æ„</strong>ã€‚</p>
<blockquote>
<p><strong>é‡æ„/åè¯</strong>ï¼Œå¯¹è½¯ä»¶å†…éƒ¨çš„ä¸€ç§è°ƒæ•´ï¼Œç›®çš„æ˜¯åœ¨ä¸æ”¹å˜è½¯ä»¶å¯è§‚å¯Ÿè¡Œä¸ºçš„å‰æä¸‹ï¼Œæé«˜å…¶å¯ç†è§£æ€§ï¼Œé™ä½å…¶ä¿®æ”¹æˆæœ¬ã€‚<br><strong>Refactoring</strong> (noun): a change made to the internal structure of software to make it easier to understand and cheaper to modify without changing its observable behavior.</p>
</blockquote>
<blockquote>
<p><strong>é‡æ„/åŠ¨è¯</strong>ï¼Œä½¿ç”¨ä¸€ç³»åˆ—çš„é‡æ„æ‰‹æ³•ï¼Œåœ¨ä¸æ”¹å˜è½¯ä»¶å¯è§‚å¯Ÿè¡Œä¸ºçš„å‰æä¸‹ï¼Œè°ƒæ•´å…¶ç»“æ„ã€‚<br><strong>Refactoring</strong> (verb): to restructure software by applying a series of refactorings without changing its observable behavior.</p>
</blockquote>
<h2 id="ä¸¤é¡¶å¸½å­"><a href="#ä¸¤é¡¶å¸½å­" class="headerlink" title="ä¸¤é¡¶å¸½å­"></a>ä¸¤é¡¶å¸½å­</h2><p>ç”±<strong><em>Kent Beck</em></strong>æå‡ºçš„ä¸¤é¡¶å¸½å­ç†è®ºï¼Œè¡¨ç¤ºç¨‹åºå‘˜çš„å·¥ä½œæ—¶é—´åˆ†é…ç»™ä¸¤ç§æˆªç„¶ä¸åŒçš„è¡Œä¸ºï¼š<code>æ·»åŠ æ–°åŠŸèƒ½</code>å’Œ<code>é‡æ„</code>ã€‚å¤–å›½å‹äººæ˜¯çœŸå–œæ¬¢ç”¨å¸½å­åšæ¯”å–»â€¦</p>
<h2 id="ä¸ºä½•é‡æ„"><a href="#ä¸ºä½•é‡æ„" class="headerlink" title="ä¸ºä½•é‡æ„"></a>ä¸ºä½•é‡æ„</h2><ul>
<li>é‡æ„æ”¹è¿›è½¯ä»¶çš„è®¾è®¡</li>
<li>é‡æ„ä½¿è½¯ä»¶æ›´å®¹æ˜“ç†è§£</li>
<li>é‡æ„å¸®åŠ©å‘ç°bug</li>
<li>é‡æ„æé«˜ç¼–ç¨‹é€Ÿåº¦</li>
</ul>
<p>åœ¨æ­¤æˆ‘æŠŠç¨‹åºå‘˜ç†æƒ³ä¸­é‡æ„åº”è¯¥å®ç°çš„æ•ˆæœå›¾æ‘˜å½•ä¸€ä¸‹ï¼š<br><img src="/img/pseudograph.png" alt="pseudograph.png"></p>
<h2 id="ä½•æ—¶é‡æ„"><a href="#ä½•æ—¶é‡æ„" class="headerlink" title="ä½•æ—¶é‡æ„"></a>ä½•æ—¶é‡æ„</h2><blockquote>
<p><strong><em>The Rule of Three</em></strong><br>Hereâ€™s a guideline Don Roberts gave me: The first time you do something, you just do it. The second time you do something similar, you wince at the duplication, but you do the duplicate thing anyway. The third time you do something similar, you refactor.<br>Or for those who like baseball: Three strikes, then you refactor.<br><strong><em>ä¸‰æ¬¡æ³•åˆ™</em></strong><br>Don Robertsåˆ†äº«çš„å‡†åˆ™ä¸­è¯´åˆ°ï¼Œå‡¡é‡äº‹ä¹Ÿï¼Œæ—¦ä¸€ä¸”åšï¼Œé‡ä¹‹å†ä¹Ÿï¼Œè¹™çœ‰åšä¹‹ï¼Œå…¶ä¸‰é‡ä¹‹ï¼Œå½“æ€é‡æ„ã€‚</p>
</blockquote>
<ul>
<li>é¢„å¤‡æ€§é‡æ„ï¼šè®©æ·»åŠ æ–°åŠŸèƒ½æ›´å®¹æ˜“</li>
<li>å¸®åŠ©ç†è§£çš„é‡æ„ï¼šä½¿ä»£ç æ›´æ˜“æ‡‚</li>
<li>æ¡åƒåœ¾å¼é‡æ„</li>
<li>æœ‰è®¡åˆ’çš„é‡æ„å’Œè§æœºè¡Œäº‹çš„é‡æ„</li>
<li>é•¿æœŸé‡æ„</li>
<li>å¤å®¡ä»£ç æ—¶é‡æ„</li>
</ul>
<p>è¯»è‡³æ­¤å¤„æˆ‘ä¸ç”±å¾—å¼€å§‹åæ€å·¥ä½œä»¥æ¥é‡åˆ°çš„è®¸å¤šé¡¹ç›®ï¼Œæœ‰äº›æ˜¯é‡å¤´å¼€å§‹è®¾è®¡ï¼Œæœ‰äº›æ˜¯åŠé€”æ¥æ‰‹ï¼Œåœ¨è‡ªå·±ç®¡è¾–å†…å¤§åŠ¨å¹²æˆˆè€…æœ‰ä¹‹ï¼Œåœ¨åˆ«äººå£ç‚‰ä¸Šé›¶æ•²ç¢æ‰“è€…æœ‰ä¹‹ã€‚é¡¹ç›®ç»éªŒç§¯ç´¯çš„è¶Šå¤šï¼Œè¶Šæ„Ÿè§‰åˆ°æ¶æ„çš„é‡è¦æ€§ã€‚æ‰€è°“æ¶æ„ï¼Œå¹¶ä¸æ˜¯archçš„ç‰¹æƒï¼Œé€šå¸¸æƒ…å†µæ˜¯çœŸæ­£è´Ÿè´£åŠŸèƒ½å®ç°çš„äººå…ˆè‰æ‹Ÿå‡ºç³»ç»Ÿçš„æ¶æ„ï¼Œå†å’Œæ¶æ„å¸ˆæ ¹æ®æ–‡æ¡£å°±ç»†èŠ‚è¿›è¡Œè®¨è®ºã€‚è€Œä¸€ä¸ªç³»ç»Ÿçš„å¥½åï¼Œå¾€å¾€å¯ä»¥ä»åç»­ç»æ‰‹è€…çš„å£å£ç›¸ä¼ ä¸­è·çŸ¥ä¸€äºŒï¼Œå°½ç®¡â€œè–„å¤åšä»Šâ€çš„ä¼ ç»Ÿåœ¨æŠ€æœ¯äººå‘˜ä¸­ä¹Ÿå¹¿ä¸ºæµä¼ ã€‚æ¥æ‰‹ä»–äººä¸šåŠ¡æ—¶ï¼Œå¾€å¾€æœ‰å°¾å¤§ä¸æ‰ä¹‹æƒ‘ï¼Œä¸€åˆ™åœ¨äºé¡¹ç›®çš„tech leaderæ˜¯å¦æœ‰ä¸°å¯Œçš„é¡¹ç›®æ¥æ‰‹ç»éªŒï¼Œèƒ½å¤Ÿåœ¨äº¤æ¥è¿‡ç¨‹ä¸­å¿«é€ŸæŒæ¡ä¸šåŠ¡åŠŸèƒ½çš„ä¸ƒå¯¸å¹¶ä»åŸç”Ÿå›¢é˜Ÿä¸­è·å¾—ç»éªŒï¼Œå¦å¤–æ¥æ‰‹è€…å¾€å¾€è‹¦æ¼äºï¼Œä»£ç ç»„ç»‡æ··ä¹±ï¼Œå˜é‡ä¸­é—´çŠ¶æ€å­˜å‚¨ä»‹è´¨/å˜åŒ–æ³•åˆ™ä¸æ˜ï¼Œåœ¨ç¼ºä¹æ–‡æ¡£ï¼ˆæ–‡æ¡£ç®¡ç†æ··ä¹±/ç¼ºä¹å®æ•ˆæ€§ï¼‰çš„æƒ…å†µä¸‹å­¦ä¹ æˆæœ¬å¤§å¤§å¢åŠ ã€‚<br>è€Œå¦ä¸€ä½åŒäº‹æ¥æ‰‹çš„<strong><em>System Refine</em></strong>å·¥ä½œä¸­ï¼Œéœ€è¦å°†ç³»ç»Ÿä»£ç é‡Œç»å¹´ç´¯æœˆç´¯ç§¯çš„â€œç‰¹æ•ˆè¯â€ä»£ç è¿›è¡Œåˆ†æè¯„ä¼°å¹¶å°½å¯èƒ½ç§»é™¤ç§¯å¼Šã€‚ä½œä¸ºå¶å°”åå¥¹æ—è¾¹å¸®ç€åˆ†æè¿‡ä¸€æ®µæ—¶é—´çš„ç»å†è€…ï¼Œæˆ‘å¤§æ¦‚èƒ½æ˜ç™½ä¸ºä»€ä¹ˆå¥¹çš„å·¥ä½œæ—¶é—´ç›´çº¿æ”€å‡ã€‚è¿™ç±»ä»£ç çš„ç‰¹è´¨å¾€å¾€æ˜¯åˆ›é€ è€…/ç»æ‰‹è€…å¤§å¤šå·²ç»ç¦»èŒæˆ–è€…è¿œç¦»codingä¸€çº¿ï¼Œæ²¡æœ‰æ˜ç¡®çš„æ–¹æ³•æ³¨é‡Šï¼Œæœ‰å¾ˆå¼ºçš„ä¸Šä¸‹æ¸¸ä¸šåŠ¡ä¾èµ–ã€‚å› æ­¤åˆ†æèµ·æ¥å¾€å¾€éœ€è¦ç»è¿‡æå‡ºçŒœæµ‹â€”â€”æœ¬åœ°debugéªŒè¯çŒœæµ‹â€”â€”æ‰¾åˆ°ä¸Šä¸‹æ¸¸clientç¡®è®¤æ˜¯å¦ä»æ—§éœ€è¦çš„å‘¨æœŸæ€§åå¤å·¥åºã€‚è¿™äº›ç‰¹æ•ˆè¯ä»£ç ï¼Œæ— éæ˜¯ä¸šåŠ¡éœ€æ±‚ä¸‹ï¼Œç¬¨æ‹™çš„ç³»ç»Ÿä¸ºäº†æ¥çº³æ–°çš„åŠŸèƒ½äº§ç”Ÿçš„æ’å¼‚ååº”ï¼Œå¼€å‘è€…ä¸ºäº†å¿«é€Ÿåœ¨ä¸¤å¹¢å¤§æ¥¼é—´å»ºç«‹é€šé“ï¼Œæ— æš‡æµ‹é‡é¢„ç•™æ¥å£çš„å¤§å°æ˜¯å¦åˆé€‚ï¼Œè¦ä¹ˆæ˜¯æŠŠå£å­æ‰¯æ‰¯å¤§ï¼Œè¦ä¹ˆæ˜¯ç”¨ç‰¹æ®Šè´¨åœ°çš„ææ–™æŠŠæ¥å£å¡å¡ç´§ï¼Œæœ«äº†è¿˜åœ¨ä¸èµ·çœ¼å¤„æ‰“å‡ é¢—è‡³å…³é‡è¦çš„èºä¸é’‰ã€‚å·¥æœŸç»“æŸæ¥¼ç›˜äº¤ä»˜åå°±ä¸å†æƒ³ç€æ€ä¹ˆä¼˜åŒ–åŸæœ‰çš„ä¸åˆç†ç»“æ„ã€‚<br>ä½†å…¶å®ä½œè€…ä¹Ÿæ‰¿è®¤ï¼Œå®é™…æƒ…å†µä¸‹ï¼Œå½“ä¸€å—ugly codeçš„å­˜åœ¨ä¸å½±å“ç°æœ‰ä¸šåŠ¡/æ¥æ´½æ–°çš„åŠŸèƒ½æ—¶ï¼Œå¤§éƒ¨åˆ†æƒ…å†µä¸‹æ˜¯å¯ä»¥å®¹å¿çš„ã€‚è€Œä¸€ä¸ªç³»ç»Ÿçš„é‡æ„éš¾åº¦ä¸€æ—¦è¿‡å¤§ï¼Œé‚£è¿æ¥çš„å°±å°†æ˜¯æ¨ç¿»é‡å»ºã€‚<br>å¤§äºº ä¸æ˜¯æ—¶ä»£å˜äº† æœ•çš„å¤§æ¸…äº¡äº† æ˜¯å› ä¸ºå…¶èº«ä¸Šå†æ²¡æœ‰ä¸€ç‚¹èƒ½å¤Ÿæµé€šçš„è¡€æ¶²äº†</p>
<h2 id="é‡æ„çš„æŒ‘æˆ˜"><a href="#é‡æ„çš„æŒ‘æˆ˜" class="headerlink" title="é‡æ„çš„æŒ‘æˆ˜"></a>é‡æ„çš„æŒ‘æˆ˜</h2><ul>
<li>å»¶ç¼“æ–°åŠŸèƒ½å¼€å‘</li>
<li>ä»£ç æ‰€æœ‰æƒ</li>
<li>åˆ†æ”¯/ç‰ˆæœ¬æ§åˆ¶</li>
<li>æµ‹è¯•</li>
<li>é—ç•™ä»£ç </li>
<li>æ•°æ®åº“<br>ä½œè€…ç½—åˆ—äº†ä¸å°‘é‡æ„æ—¶ä¼šé¢ä¸´çš„é˜»ç¢ï¼Œå€¼å¾—ä¸€æçš„äº‹å¯¹äºæœ€åä¸¤ç‚¹ï¼Œä½œè€…ä»‹ç»äº†ä¸¤æœ¬æœ‰æŒ‡å¯¼ä½œç”¨çš„ä¹¦ï¼š</li>
<li>ã€Šä¿®æ”¹ä»£ç çš„è‰ºæœ¯ Working Effectively with Legacy Codeã€‹[Feathers]</li>
<li>ã€Š<a href="https://martinfowler.com/articles/evodb.html" target="_blank" rel="noopener">æ¸è¿›å¼æ•°æ®åº“è®¾è®¡</a>ã€‹</li>
<li>ã€Šæ•°æ®åº“é‡æ„ Refactoring Databasesã€‹<br>æ—¥åæœ‰æ—¶é—´åº”è¯¥ä¼šæ‰¾æ¥ä¸€å¹¶äº†è§£ä¸€ä¸‹ã€‚<blockquote>
<p>é‡æ„çš„ä¸‰å¤§åŸºçŸ³<br>è‡ªæµ‹è¯•ä»£ç ï¼ŒæŒç»­é›†æˆï¼Œé‡æ„</p>
</blockquote>
</li>
</ul>
<h2 id="ç¬¬äºŒç« æ€»ç»“"><a href="#ç¬¬äºŒç« æ€»ç»“" class="headerlink" title="ç¬¬äºŒç« æ€»ç»“"></a>ç¬¬äºŒç« æ€»ç»“</h2><p>ä½œè€…åœ¨ç¬¬äºŒç« çš„è§‚ç‚¹åœ¨å¦‚ä»Šçœ‹æ¥æµ…æ˜¾æ˜“æ‡‚ï¼Œæ˜¯å› ä¸ºé‡æ„çš„ç†å¿µå¦‚ä»Šå·²ç»ä¸ºå¤§å¤šæ•°æŠ€æœ¯äººå‘˜æ¥å—ã€‚åŒæ ·çš„ï¼Œåœ¨å‡ åå¹´å‰é‡æ„æ‰€é¢ä¸´çš„è¯¸å¤šå›°éš¾ï¼Œä¹Ÿé€æ¸è¢«æŒç»­äº¤ä»˜/æŒç»­é›†æˆ/è‡ªåŠ¨åŒ–IDEä¸€ä¸€è§£å†³ã€‚åœ¨æˆ‘ä»¬å°ç»„çš„å·¥ä½œä¸­ï¼Œå°è§„æ¨¡çš„é‡æ„ä»»åŠ¡å·²ç»æˆä¸ºäº†æˆ‘ä»¬æ—¥å¸¸å·¥ä½œé‡çš„ä¸€éƒ¨åˆ†ã€‚æˆ‘è¿‘æœŸçš„ä¸€ä¸ªæ¯”è¾ƒambitiousçš„è®¡åˆ’ï¼Œå°±æ˜¯ç»™ä¸€ä¸ªé¡¹ç›®å¼•å…¥æµå¼éªŒè¯ä»¥å–ä»£ä»¥å¾€éªŒè¯é€»è¾‘ç§¯å‹åœ¨ä¸€ä¸ªéªŒè¯ç±»ä¸­çš„åšæ³•ã€‚</p>
<p>â€”â€”æœªå®Œå¾…ç»­â€”â€”<br>2020.05.05</p>

      
    </div>
    
  </div>
  
    
    <div class="copyright">
        <p><span>Title:</span><a href="/2020/05/04/code_refractoring/">é‡æ„æ”¹å–„ç°æœ‰ä»£ç çš„è®¾è®¡ç¬”è®°</a></p>
        <p><span>Author:</span><a href="/" title="Back to Homepage">Jarvis Yao</a></p>
        <p><span>Created:</span>2020-05-04, 11:06:09</p>
        <p><span>Updated:</span>2020-05-05, 16:52:17</p>
        <p>
            <span>Full URL:</span><a class="post-url" href="/2020/05/04/code_refractoring/" title="é‡æ„æ”¹å–„ç°æœ‰ä»£ç çš„è®¾è®¡ç¬”è®°">https://hejabvbreus11.github.io/2020/05/04/code_refractoring/</a>
            <span class="copy-path" data-clipboard-text="From https://hejabvbreus11.github.io/2020/05/04/code_refractoring/ã€€ã€€By Jarvis Yao" title="Copy Article&#39;s Link &amp; Author"><i class="fa fa-clipboard"></i></span>
            <script> var clipboard = new Clipboard('.copy-path'); </script>
        </p>
        <p>
            <span>License:</span><i class="fa fa-creative-commons"></i> <a rel="license noopener" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" title="CC BY-NC-SA 4.0 International" target = "_blank">"CC BY-NC-SA 4.0"</a> Keep Link &amp; Author if Distribute.
        </p>
    </div>



    <nav id="article-nav">
        
        
            <div id="article-nav-older" class="article-nav-title">
                <a href="/2020/05/03/first-blog/">
                    Hello World
                </a>
            </div>
        
    </nav>

  
</article>

    <div id="toc" class="toc-article">
        <strong class="toc-title">Contents</strong>
        
            <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#å‰æ–‡"><span class="toc-number">1.</span> <span class="toc-text">å‰æ–‡</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ç¬¬ä¸€ç« -é‡æ„ï¼Œç¬¬ä¸€ä¸ªç¤ºä¾‹"><span class="toc-number">2.</span> <span class="toc-text">ç¬¬ä¸€ç«  é‡æ„ï¼Œç¬¬ä¸€ä¸ªç¤ºä¾‹</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#åŸä¹¦å®ç°"><span class="toc-number">2.1.</span> <span class="toc-text">åŸä¹¦å®ç°</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ç¬¬ä¸€ç« æ€»ç»“"><span class="toc-number">2.2.</span> <span class="toc-text">ç¬¬ä¸€ç« æ€»ç»“</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ç¬¬äºŒç« -é‡æ„çš„åŸåˆ™"><span class="toc-number">3.</span> <span class="toc-text">ç¬¬äºŒç«  é‡æ„çš„åŸåˆ™</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#ä¸¤é¡¶å¸½å­"><span class="toc-number">3.1.</span> <span class="toc-text">ä¸¤é¡¶å¸½å­</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ä¸ºä½•é‡æ„"><span class="toc-number">3.2.</span> <span class="toc-text">ä¸ºä½•é‡æ„</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ä½•æ—¶é‡æ„"><span class="toc-number">3.3.</span> <span class="toc-text">ä½•æ—¶é‡æ„</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#é‡æ„çš„æŒ‘æˆ˜"><span class="toc-number">3.4.</span> <span class="toc-text">é‡æ„çš„æŒ‘æˆ˜</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ç¬¬äºŒç« æ€»ç»“"><span class="toc-number">3.5.</span> <span class="toc-text">ç¬¬äºŒç« æ€»ç»“</span></a></li></ol></li></ol>
        
    </div>
    <style>
        .left-col .switch-btn,
        .left-col .switch-area {
            display: none;
        }
        .toc-level-3 i,
        .toc-level-3 ol {
            display: none !important;
        }
    </style>

    <input type="button" id="tocButton" value="Hide"  title="Show or Hide Table of Contents">

    <script>
        yiliaConfig.toc = ["Hide", "Show", !!"false"];
    </script>



    
<div class="share">
    
        <div class="bdsharebuttonbox">
            <a href="#" class="fa fa-twitter bds_twi" data-cmd="twi" title="åˆ†äº«åˆ°æ¨ç‰¹"></a>
            <a href="#" class="fa fa-weibo bds_tsina" data-cmd="tsina" title="åˆ†äº«åˆ°æ–°æµªå¾®åš"></a>
            <a href="#" class="fa fa-qq bds_sqq" data-cmd="sqq" title="åˆ†äº«ç»™ QQ å¥½å‹"></a>
            <a href="#" class="fa fa-files-o bds_copy" data-cmd="copy" title="å¤åˆ¶ç½‘å€"></a>
            <a href="#" class="fa fa fa-envelope-o bds_mail" data-cmd="mail" title="é€šè¿‡é‚®ä»¶åˆ†äº«"></a>
            <a href="#" class="fa fa-weixin bds_weixin" data-cmd="weixin" title="ç”Ÿæˆæ–‡ç« äºŒç»´ç "></a>
            <a href="#" class="fa fa-share-alt bds_more" data-cmd="more"></i></a>
        </div>
        <script>
            window._bd_share_config={
                "common":{"bdSnsKey":{},"bdText":"é‡æ„æ”¹å–„ç°æœ‰ä»£ç çš„è®¾è®¡ç¬”è®°ã€€| Pikachu-Thunderboltã€€","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"24"},"share":{}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
        </script>
    

    
</div>







    



  
  <!-- Gitalkè¯„è®ºæ’ä»¶é€šç”¨ä»£ç  -->
<div id="gitalk"></div>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
<script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
<script>
const gitalk = new Gitalk({
  clientID: '1b8c96d29e2817b0196d',
  clientSecret: '7c52431d0234a3b19cac9e550eb1cde165bcad27',
  repo: 'Pikachu-Thunderbolt.github.io',
  owner: 'Pikachu-Thunderbolt',
  admin: ['Pikachu-Thunderbolt'],
  id: location.pathname,      // Ensure uniqueness and length less than 50
  distractionFreeMode: false  // Facebook-like distraction free mode
})

gitalk.render('gitalk')
</script>
<!-- Gitalkä»£ç ç»“æŸ -->
  




    <div class="scroll" id="post-nav-button">
        
            <a href="/" title="Back to Homepage"><i class="fa fa-home"></i></a>
        

        <a title="Mini Archives"><i class="fa fa-bars"></i><i class="fa fa-times"></i></a>

        
            <a href="/2020/05/03/first-blog/" title="Next: Hello World">
                <i class="fa fa-angle-right"></i>
            </a>
        
    </div>

    <ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2020/05/04/code_refractoring/">é‡æ„æ”¹å–„ç°æœ‰ä»£ç çš„è®¾è®¡ç¬”è®°</a></li><li class="post-list-item"><a class="post-list-link" href="/2020/05/03/first-blog/">Hello World</a></li></ul>




    <script>
        
    </script>
</div>
      <footer id="footer">
    <div class="outer">
        <div id="footer-info">
            <div class="footer-left">
                <i class="fa fa-copyright"></i> 
                2020 Jarvis Yao
            </div>
            <div class="footer-right">
                <a href="http://hexo.io/" target="_blank" title="A fast, simple &amp; powerful blog framework">Hexo</a>  Theme <a href="https://github.com/MOxFIVE/hexo-theme-yelee" target="_blank" title="Another simple and elegant theme for Hexo  v3.5">Yelee</a> by MOxFIVE <i class="fa fa-heart animated infinite pulse"></i>
            </div>
        </div>
        
            <div class="visit">
                
                    <span id="busuanzi_container_site_pv" style='display:none'>
                        <span id="site-visit" title="Site Visitors"><i class="fa fa-user" aria-hidden="true"></i><span id="busuanzi_value_site_uv"></span>
                        </span>
                    </span>
                
                
                    <span>| </span>
                
                
                    <span id="busuanzi_container_page_pv" style='display:none'>
                        <span id="page-visit"  title="Page Hits"><i class="fa fa-eye animated infinite pulse" aria-hidden="true"></i><span id="busuanzi_value_page_pv"></span>
                        </span>
                    </span>
                
            </div>
        
    </div>
</footer>
    </div>
    
<script data-main="/js/main.js" src="//cdn.bootcss.com/require.js/2.2.0/require.min.js"></script>

    <script>
        $(document).ready(function() {
            var iPad = window.navigator.userAgent.indexOf('iPad');
            if (iPad > -1 || $(".left-col").css("display") === "none") {
                var bgColorList = ["#9db3f4", "#414141", "#e5a859", "#f5dfc6", "#c084a0", "#847e72", "#cd8390", "#996731"];
                var bgColor = Math.ceil(Math.random() * (bgColorList.length - 1));
                $("body").css({"background-color": bgColorList[bgColor], "background-size": "cover"});
            }
            else {
                var backgroundnum = 5;
                var backgroundimg = "url(/background/bg-x.jpg)".replace(/x/gi, Math.ceil(Math.random() * backgroundnum));
                $("body").css({"background": backgroundimg, "background-attachment": "fixed", "background-size": "cover"});
            }
        })
    </script>





    <script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script src="//cdn.bootcss.com/mathjax/2.6.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


<div class="scroll" id="scroll">
    <a href="#" title="Back to Top"><i class="fa fa-arrow-up"></i></a>
    <a href="#comments" onclick="load$hide();" title="Comments"><i class="fa fa-comments-o"></i></a>
    <a href="#footer" title="Go to Bottom"><i class="fa fa-arrow-down"></i></a>
</div>
<script>
    // Open in New Window
    
        var oOpenInNew = {
            
            
            
            
            
            
             archives: ".archive-article-title", 
             miniArchives: "a.post-list-link", 
            
             friends: "#js-friends a", 
             socail: ".social a" 
        }
        for (var x in oOpenInNew) {
            $(oOpenInNew[x]).attr("target", "_blank");
        }
    
</script>

    <script>
        var originTitle = document.title;
        var titleTime;
        document.addEventListener("visibilitychange", function() {
            if (document.hidden) {
                document.title = "(ã¤ã‚§âŠ‚) æˆ‘è—å¥½äº†å“¦~ " + originTitle;
                clearTimeout(titleTime);
            }
            else {
                document.title = "(*Â´âˆ‡ï½€*) è¢«ä½ å‘ç°å•¦~ " + originTitle;
                titleTime = setTimeout(function() {
                    document.title = originTitle;
                }, 2000);
            }
        })
    </script>

<script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
</script>
  </div>
</body>
</html>